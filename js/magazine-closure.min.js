//***************************************************************************** 
//main
var mg=function(a){var b={options:{directory:"magazine",json:"magazine/magazine.json",numberOfPagesToLoadOnInit:4,sliderMove:800,fullpage:!1,animationTime:300,animationType:"linear",sidebar:!0,sidebarFixed:!0},maxPage:1,startLeft:-80,step:85,numberOfPagesLoaded:0,currentSlideId:"slide-1",currentPage:0,animation:window.WebKitCSSMatrix?"3d":"",touchEnabled:typeof document.ontouchmove!="undefined"?!0:!1,mouse:{initiated:!1},init:function(){b.loadOptions(b.start),b.sidebar=$("#mg-sidebar"),b.slider=$("#mg-slider"),b.firstSlide=$("#mg-slide-1"),b.buttonOpen=$("#mg-sidebar-button-open"),b.buttonClose=$("#mg-sidebar-button-close"),b.bindEvents()},start:function(){b.maxPage=b.get("contents").length-1,b.get("fullpage")===!0&&($("body").attr("id","fullpage"),b.startLeft=-100,b.step=100),b.options.sidebar===!0&&(b.options.sidebarFixed===!0?$("body").addClass("fixed"):(b.buttonOpen.show(),b.buttonClose.show()),b.loadSidebar()),b.slides=[];for(var a=0;a<=4;a++)b.slides.push({slideId:"slide-"+a,left:b.startLeft,page:a}),b.startLeft+=b.step;b.loadPage($("#mg-slide-1"),"1"),b.loadPage($("#mg-slide-2"),"2"),b.loadPage($("#mg-slide-3"),"3"),b.loadPage($("#mg-slide-4"),"4")},get:function(c){return typeof b.options[c]!="undefined"?b.options[c]:a},set:function(a,c){b.options[a]=c}};return b}();window.mg=mg||{},function(a,b){a.loadSidebar=function(){a.sidebar.load(a.get("directory")+"/sidebar.html",a.loadSidebarSuccess)},a.loadSidebarSuccess=function(){a.touchEnabled===!0?(a.buttonOpen.tap(a.sidebarShow),a.buttonClose.tap(a.sidebarHide)):(a.buttonOpen.bind("click",a.sidebarShow),a.buttonClose.bind("click",a.sidebarHide)),$.os.ios===!0&&!(parseInt($.os.version)<5)},a.loadPrev=function(){var b=a.slides[0].page-1;if(b>0){var c=a.slides.pop(),d={slideId:c.slideId,left:a.slides[0].left-a.step,page:a.slides[0].page-1};a.slides.unshift(d);var e=$("#mg-"+d.slideId);e.css("left",d.left+"%"),a.loadPage(e,d.page),a.currentslideId=a.slides[1].slideId}},a.loadNext=function(){var b=a.slides[a.slides.length-1].page+1;if(b<=a.maxPage+1){var c=a.slides.shift(),d={slideId:c.slideId,left:a.slides[a.slides.length-1].left+a.step,page:a.slides[a.slides.length-1].page+1};a.slides.push(d);var e=$("#mg-"+d.slideId);e.css("left",d.left+"%"),a.loadPage(e,d.page),a.currentslideId=a.slides[1].slideId}},a.loadPage=function(b,c){b.load(a.get("directory")+"/"+c+".html",function(){a.loadSuccess(b)})},a.loadSuccess=function(b){b.show(),a.numberOfPagesLoaded++,a.get("numberOfPagesToLoadOnInit")===a.numberOfPagesLoaded&&(a.orientation(!1),a.removeLoadingIndicator())},a.removeLoadingIndicator=function(){$("#mg-loader").remove()}}(mg),function(a,b){a.prev=function(){a.currentPage--;if(a.currentPage<0)a.currentPage=0;else{var b=(a.getWidth(a.firstSlide)+a.getMargin(a.firstSlide))*a.currentPage*-1;a.animate(a.slider,b),a.currentPage<a.maxPage-2&&a.loadPrev()}},a.next=function(){a.currentPage++;if(a.currentPage>a.maxPage)a.currentPage=a.maxPage;else{var b=(a.getWidth(a.firstSlide)+a.getMargin(a.firstSlide))*a.currentPage*-1;a.animate(a.slider,b),a.currentPage>1&&a.loadNext()}},a.center=function(){a.resetWidth(),a.resetMargin();var b=(a.getWidth(a.firstSlide)+a.getMargin(a.firstSlide))*a.currentPage*-1;a.animate(a.slider,b),a.sidebarHide("fast")},a.gotoPage=function(){},a.sidebarShow=function(){a.buttonOpen.hide(),a.buttonClose.show();var b=a.getWidth(a.sidebar);a.animate(a.sidebar,b),a.animate(a.buttonClose,b),a.animate(a.buttonOpen,b)},a.sidebarHide=function(b){b=b||"slow";var c=a.get("animationTime");if(b==="fast")var c="0";a.buttonOpen.show(),a.buttonClose.hide();var d=0;a.animate(a.sidebar,d,0,0,c),a.animate(a.buttonClose,d,0,0,c),a.animate(a.buttonOpen,d,0,0,c)},a.animate=function(b,c,d,e,f,g){var c=c||0,d=d||0,e=e|0,f=f||a.get("animationTime"),g=g||a.get("animationType");a.animation==="3d"?$.os.ios?b.animate({translate3d:c+"px,"+d+"px,"+e+"px"},f,g):b.animate({translate3d:c+"px,"+d+"px,"+e+"px"},f,g):b.animate({translate:c+"px"},f,g)}}(mg),function(a,b){$("body").bind("touchmove",function(a){a.elementIsEnabled||a.preventDefault()}),a.bindEvents=function(){a.touchEnabled===!0?(window.addEventListener("orientationchange",a.orientation,!1),a.slider.swipeRight(function(){a.prev()}),a.slider.swipeLeft(function(){a.next()})):(window.addEventListener("resize",a.center,!1),$(".mg-slider-page").bind("mousedown",a.mousedown),$(".mg-slider-page").bind("mousemove",a.mousemove),$(".mg-slider-page").bind("mouseup",a.mouseup))},a.orientation=function(b){var c=window.orientation;console.log(c);switch(c){case 0:case 180:c="portrait",$(".landscape").hide(),$(".portrait").show();break;default:c="landscape",$(".portrait").hide(),$(".landscape").show()}a.center()},a.mousedown=function(b){a.mouse.startX=b.clientX,a.mouse.startY=b.clientY,a.mouse.initiated=!0},a.mousemove=function(b){if(a.mouse.initiated===!1)return;a.mouse.X=b.clientX,a.mouse.Y=b.clientY},a.mouseup=function(b){a.mouse.startX-a.mouse.X>0?a.next():a.prev(),a.mouse.initiated=!1}}(mg),function(a,b){var c;a.loadOptions=function(b){c=b,a.loadJson(a.setOptions)},a.loadJson=function(b){$.getJSON(a.options.json,b,function(a){console.log(a)})},a.setOptions=function(b){for(var d in b)a.options[d]=b[d];c()},a.getWidth=function(b){a.widthList=a.widthList||{};if(typeof a.widthList[b[0]["id"]]!="undefined")return a.widthList[b[0].id];var c=b.css("width");return c=parseInt(c.replace(/px/,"")),a.widthList[b[0].id]=c,c},a.resetWidth=function(){a.widthList={}},a.getMargin=function(b){a.marginList=a.marginList||{};if(typeof a.marginList[b[0]["id"]]!="undefined")return a.marginList[b[0].id];var c=b.css("margin-left");return c=parseInt(c.replace(/px/,"")),a.marginList[b[0].id]=c,c},a.resetMargin=function(){a.marginList={}}}(mg),mg.init();